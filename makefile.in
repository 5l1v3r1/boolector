.SUFFIXES: .o .c .cc
.c.o:
	$(CC) $(CFLAGS) -c $<
.cc.o:
	$(CC) $(CFLAGS) -c $<
MAKEFLAGS=-j $(if $(CORES),$(CORES),1)
CC=@CC@
INCS=@INCS@
CFLAGS=@CFLAGS@
OBJS=@OBJS@
LIBS=@LIBS@
LDEPS=@LDEPS@
VERSION=$(shell cat VERSION)
LIBOBJ= $(addsuffix .o,$(basename $(wildcard btor*.c))) boolector.o $(OBJS)
TESTOBJ=$(addsuffix .o,$(basename $(wildcard test*.c)))
SRC=$(shell ls *.c *.h *.cc)
all: libboolector.a boolector test synthebtor deltabtor basicbtor
all: dimacs2smt2
-include dependencies
analyze:
	clang --analyze $(CFLAGS) $(SRC)
btorpreco.o: btorsat.h btorpreco.h btorpreco.cc makefile
btorminisat.o: btorsat.h btorminisat.h btorminisat.cc makefile
	$(CC) $(shell echo '$(CFLAGS)'|sed -e 's,-Wall -Wextra ,,') -c btorminisat.cc
dependencies: btorconfig.h $(SRC) makefile
	rm -f $@; $(CC) $(CFLAGS) -MM *.c|sed -e 's,:,: makefile,'>$@
boolector: boolectormain.o libboolector.a $(LDEPS)
	$(CC) $(CFLAGS) -o $@ boolectormain.o -L. -lboolector $(LIBS)
test: $(TESTOBJ) libboolector.a  $(LDEPS)
	$(CC) $(CFLAGS) -o $@ $(TESTOBJ) -L. -lboolector $(LIBS)
synthebtor: synthebtor.o libboolector.a $(LDEPS)
	$(CC) $(CFLAGS) -o $@ synthebtor.o -L. -lboolector $(LIBS)
deltabtor: deltabtor.c makefile $(LDEPS)
	$(CC) $(CFLAGS) -o $@ deltabtor.c
basicbtor: basicbtor.c makefile $(LDEPS)
	$(CC) $(CFLAGS) -o $@ basicbtor.c
dimacs2smt2: dimacs2smt2.c makefile
	$(CC) $(CFLAGS) -o $@ dimacs2smt2.c
libboolector.a: $(LIBOBJ)
	rm -f $@
	ar rc $@ $(LIBOBJ)
	ranlib $@
btorconfig.h: makefile VERSION mkconfig
	rm -f $@; ./mkconfig > $@
clean:
	rm -f test boolector deltabtor synthebtor basicbtor
	rm -f *.o *.a
	rm -f *.gcda *.gcno *.gcov  *.gch *.plist
	rm -f log/*.log *.tmp
	rm -f dependencies makefile btorconfig.h
.PHONY: all analyze clean
