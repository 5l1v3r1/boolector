#!/bin/bash
cd ~/boolector
make clean
./configure -r
make
rm -r -f doc
doxygen
version=`cat VERSION`
target=/tmp/boolector-$version
rm -r -f $target
mkdir $target
mkdir ${target}/bin
mkdir ${target}/lib
mkdir ${target}/include
mkdir ${target}/examples
cp README $target
cp LICENSE $target
cp boolector ${target}/bin
cp libboolector.a ${target}/lib
cp boolector.h ${target}/include
cp -r doc $target

# copy and adapt examples
for dir in bv array
do
  mkdir ${target}/examples/$dir
  cp examples/${dir}/makefile ${target}/examples/$dir
  num=`ls examples/${dir}/*.c | wc -l`
  for ((i = 1; i <= $num; i++))
  do
    file=${dir}${i}.c
    echo '#include "../../include/boolector.h"' > ${target}/examples/${dir}/$file
    sed -n '2,$p' examples/${dir}/$file >> ${target}/examples/${dir}/$file
  done
done
