#!/bin/bash
i=0
file="/tmp/test$$.btor"
while true 
do 
  ((i++))
  echo -n "Test "$i" (rwl2): "
  btorgen 2> /dev/null > $file 
  boolector -rwl2 -rl 100000 $file
  retval=$?
  if [[ $retval -ne 2 ]] && [[ $retval -ne 3 ]]; then
    echo "ERROR"
    cp $file ./error.btor
    rm -f $file
    exit
  fi
  for rwl in "rwl1" "rwl0"
  do
    echo -n "Test $i ($rwl): "
    boolector -$rwl $file 
    if [[ $? -ne $retval ]]; then
      echo "ERROR"
      cp $file ./error.btor
      rm -f $file
      exit
    fi 
  done
done
